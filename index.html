<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>Miriam's PacMan Game</title>

<style>
html,body{
  margin:0;
  padding:0;
  overflow:hidden;
  touch-action:none;
  background:#5c1a2b;
  font-family:monospace;
  text-align:center;
}

#screen{
  background:#ff9bb3;
  border:12px solid #000000;
  width:320px;
  height:450px;
  margin:20px auto;
  padding:10px;
  position:relative;
}

canvas{
  background:#ff9bb3;
  display:block;
  margin:auto;
}

#startScreen{
  position:absolute;
  inset:0;
  background:#ff9bb3;
  display:flex;
  flex-direction:column;
  justify-content:center;
  align-items:center;
  z-index:10;
}

button{
  font-size:20px;
  padding:10px 20px;
  margin-top:20px;
  background:#FF6F91;
  border:2px solid #4a0015;
  cursor:pointer;
}

#joystick{
  margin:20px auto;
  width:120px;
  height:120px;
  border-radius:50%;
  background:black;
  position:relative;
}

#stick{
  width:60px;
  height:60px;
  border-radius:50%;
  background:yellow;
  position:absolute;
  left:50%;
  top:50%;
  transform:translate(-50%,-50%);
}
</style>
</head>

<body>

<h3>Miriam's PacMan</h3>

<div id="screen">
Score: <span id="score">0</span> | Lives: <span id="lives">3</span>
<canvas id="game" width="320" height="450"></canvas>

<div id="startScreen">
  <div>
    Hii baby,<br>
    let's put your Pac-Man <br>
    skills to the test.<br>
    See you on the other side!<br>
    ------ <br>
    Hit START to play!
  </div>
  <button onclick="startGame()">START</button>
</div>
</div>

<div id="joystick"><div id="stick"></div></div>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");
const scoreEl = document.getElementById("score");
const livesEl = document.getElementById("lives");
const startScreen = document.getElementById("startScreen");

const grid = 16;
const WIN_SCORE = 2;

let player, hearts, ghosts, sparkles = [], stars = [];
let score, lives, loop, state="menu";
let playerSpeedBoost = false, playerSpeedBoostTime = 0;
let winImage = new Image();
winImage.src = "jandm.png";

/* HEART */
function drawHeart(x,y){
  ctx.fillStyle="#ff3333";
  ctx.beginPath();
  ctx.arc(x*grid+8,y*grid+6,4,Math.PI,0);
  ctx.arc(x*grid+12,y*grid+6,4,Math.PI,0);
  ctx.lineTo(x*grid+10,y*grid+14);
  ctx.fill();
}

/* GHOST */
function drawGhost(g){
  const x=g.px,y=g.py,w=14,h=14;
  ctx.fillStyle=g.color;
  ctx.beginPath();
  ctx.arc(x+w/2,y+w/2,w/2,Math.PI,0);
  ctx.lineTo(x+w,y+h-3);
  ctx.lineTo(x+w-3,y+h);
  ctx.lineTo(x+w-6,y+h-3);
  ctx.lineTo(x+w-9,y+h);
  ctx.lineTo(x+w-12,y+h-3);
  ctx.lineTo(x,y+h-3);
  ctx.closePath();
  ctx.fill();

  ctx.strokeStyle="black";
  ctx.stroke();

  /* ðŸ‘‡ UPDATED EYES */
  ctx.fillStyle="#ededed";
  ctx.fillRect(x+3,y+4,3,5);
  ctx.fillRect(x+8,y+4,3,5);
}

/* PLAYER */
function drawKirby(px,py){
  ctx.fillStyle="#ff9bd4";
  ctx.beginPath();
  ctx.arc(px,py,8,0,Math.PI*2);
  ctx.fill();
  ctx.strokeStyle="black";
  ctx.stroke();

  ctx.fillStyle="#000";
  ctx.fillRect(px-3,py-2,2,4);
  ctx.fillRect(px+1,py-2,2,4);

  ctx.fillStyle="#ff6fa5";
  ctx.fillRect(px-6,py+2,2,1);
  ctx.fillRect(px+4,py+2,2,1);
}

/* SPARKLES */
function spawnSparkle(){
  sparkles.push({x:player.px+8,y:player.py+8,size:2,life:20});
}
function drawSparkles(){
  sparkles.forEach(s=>{
    ctx.fillStyle="white";
    ctx.fillRect(s.x,s.y,s.size,s.size);
    s.y-=0.5;
    s.life--;
  });
  sparkles=sparkles.filter(s=>s.life>0);
}

/* DRAW */
function draw(){
  ctx.clearRect(0,0,320,450);

  if(state==="win"){
    ctx.fillStyle="black";
    ctx.font="32px monospace";
    ctx.textAlign="center";
    ctx.fillText("YOU WIN!",160,80);
    return;
  }

  hearts.forEach(h=>drawHeart(h.x,h.y));
  drawSparkles();
  drawKirby(player.px+8,player.py+8);
  ghosts.forEach(drawGhost);
}

/* GAME OVER */
function gameOver(){
  clearInterval(loop);
  startScreen.style.display="flex";
}

/* UPDATE */
function update(){
  if(state!=="play") return;

  player.px+=player.dx*4;
  player.py+=player.dy*4;

  player.px=Math.max(0,Math.min(304,player.px));
  player.py=Math.max(0,Math.min(434,player.py));

  player.x=Math.floor(player.px/grid);
  player.y=Math.floor(player.py/grid);

  if(player.dx||player.dy) spawnSparkle();

  ghosts.forEach(g=>{
    if(!g.tx || Math.hypot(g.tx-g.px,g.ty-g.py)<2){
      g.tx=Math.random()*300;
      g.ty=Math.random()*430;
    }
    const dx=g.tx-g.px,dy=g.ty-g.py,d=Math.hypot(dx,dy);
    g.px+=dx/d*1.5;
    g.py+=dy/d*1.5;
  });

  hearts=hearts.filter(h=>{
    if(h.x===player.x && h.y===player.y){
      score++;
      scoreEl.textContent=score;
      return false;
    }
    return true;
  });

  ghosts.forEach(g=>{
    if(Math.abs(g.px-player.px)<12 && Math.abs(g.py-player.py)<12){
      lives--;
      livesEl.textContent=lives;
      player.px=160;player.py=200;
      if(lives<=0) gameOver();
    }
  });

  if(score>=WIN_SCORE){
    state="win";
    clearInterval(loop);
  }

  draw();
}

/* START */
function startGame(){
  startScreen.style.display="none";
  reset();
}

function reset(){
  state="play";
  score=0;lives=3;
  scoreEl.textContent=score;
  livesEl.textContent=lives;

  player={px:160,py:200,dx:0,dy:0};
  sparkles=[];
  hearts=[];
  for(let i=0;i<WIN_SCORE;i++){
    hearts.push({x:Math.floor(Math.random()*20),y:Math.floor(Math.random()*28)});
  }

  ghosts=[
    {px:40,py:40,color:"#cc0000"},
    {px:200,py:60,color:"#00ffff"},
    {px:100,py:200,color:"#ff8000"},
    {px:250,py:300,color:"#ff007f"}
  ];

  clearInterval(loop);
  loop=setInterval(update,50);
}

/* KEYS */
document.addEventListener("keydown",e=>{
  if(state!=="play") return;
  if(e.key==="ArrowUp"){player.dx=0;player.dy=-1;}
  if(e.key==="ArrowDown"){player.dx=0;player.dy=1;}
  if(e.key==="ArrowLeft"){player.dx=-1;player.dy=0;}
  if(e.key==="ArrowRight"){player.dx=1;player.dy=0;}
});
</script>

</body>
</html>
